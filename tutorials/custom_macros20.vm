#*
《code》
《copyright》
Authors: Wing Ming Chan, Peter Thomas
Copyright (c) 2017 Wing Ming Chan <chanw@upstate.edu>, Peter Thomas <thomaspe@upstate.edu>
MIT Licensed
Modification history:
4/5/2017 Started annotations.
《/copyright》
《documentation id=“top”》
《h2》Introduction《/h2》
《p》This format defines custom macros used to process blocks and groups. These macros are invoked
automatically. Therefore, no examples are provided.《/p》
《/documentation》
《documentation》
《code》#processAccordionGroup( $groupToBeProcessed )《/code》
《p》Processes the accordion-group to produce an accordion.《/p》
《/documentation》
《macro id=“processAccordionGroup”》
*#
#macro( processAccordionGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'accordion-group' )
        Not an Accordion group
        #stop
	#end
	
    $globalStringBuffer.setLength( 0 )
    #set( $accordionGroups = $groupToBeProcessed.getChildren( 'accordion-h2-wysiwyg-group' )  )
    
    #if( $accordionGroups.size() > 0 )
        #if( $groupToBeProcessed.getChild('accordion-expandall').value == 'Yes' )
            #set( $void = $globalStringBuffer.append( "<p><a href='#' id='expand_all'>Expand all</a></p>" ) )
        #end
        
        #set( $void = $globalStringBuffer.append( "<div class='accordion'>" ) )

        #foreach( $accordionGroup in $accordionGroups )
			#set( $void = $globalStringBuffer.append( "<h2>" ) )
			#set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $accordionGroup.getChild( 'accordion-h2' ).value ) ) )
			#set( $void = $globalStringBuffer.append( "</h2><div>" ) )
            #set( $void = $globalStringBuffer.append( $_SerializerTool.serialize( $accordionGroup.getChild( 'accordion-wysiwyg' ), false ) ) )
            #set( $void = $globalStringBuffer.append( "</div>" ) )
		#end
		#set( $void = $globalStringBuffer.append( "</div>" ) )
		$globalJDOMText.normalizeString( $globalStringBuffer.toString() )
    #end
#end
#*
《/macro》
《documentation》
《code》#processArticleFootGroup( $groupToBeProcessed )《/code》
《p》Processes the article-foot-group.《/p》
《/documentation》
《macro id=“processArticleFootGroup”》
*#
#macro( processArticleFootGroup $groupToBeProcessed )
    #import( 'site://_common_assets/formats/library/velocity/chanw_process_index_block' )
    <div>
        <hr />
   
        #set( $callCallingPage = $_XPathTool.selectSingleNode( $contentRoot, "calling-page/system-page" ) ) 
        #chanwProcessSystemPage( $callCallingPage )
        #set( $systemPageSite           = $systemPageSite.replaceAll("-dev","") )
        #set( $systemPageTitleURLd      = $systemPageTitle.replaceAll('&amp;amp;','&amp;').replaceAll(' ','%20') )
        #set( $systemPageSummaryURLd    = $systemPageSummary.replaceAll("&amp;amp;","&amp;").replaceAll(' ','%20') )

        <div class="col-sm-8 padbottom7"> ##published and categories
    ##Published On 
        #if($groupToBeProcessed.getChild("show-options").value.contains("Publish Date"))        
            Published on: $_DateTool.format( 'EEEEE, MMMM d, yyyy', $_DateTool.getDate( $systemPageStartDate ) )               
        #end
        $BR
        
    ##Published On 
        #if($groupToBeProcessed.getChild("show-options").value.contains("Author") && $currentPage.metadata.author )        
            $_EscapeTool.xml($currentPage.metadata.author )
            $BR
        #end
        
    ##Display Categories
        #if( $groupToBeProcessed.getChild("show-options").value.contains("Categories") )
            ##Find Teaser categories in article
            #set( $categoriesInArticle = $_XPathTool.selectSingleNode( $contentRoot, "calling-page/system-page/teaser" ).value ) 
    
            ##Find all category pages
            #set ( $categoryIndexBlock = $groupToBeProcessed.getChild("categories-index-block").getChild("content").getChild("system-index-block") )
            #set( $categoryListing = $_XPathTool.selectNodes( $categoryIndexBlock, "system-page[name!='index'][name!='site-map']" ) )  
            #set ($categoryMatches = [])
            #foreach( $categoryType in $categoryListing )
                #set( $categoryName = $categoryType.getChild("name").value )
                #if ($categoriesInArticle.contains($categoryName))
                    #set($void =     $categoryMatches.add("<a href='${categoryType.getChild('link').value}'>${categoryType.getChild('display-name').value}</a>") )          
                #end
            #end
            Filed under:&#160;${_DisplayTool.list( $categoryMatches )}
        #end    
        </div> ##published and categories

        <div class="alignright"> ##Buttons
    ##Share email
        #if( $groupToBeProcessed.getChild("share").value.contains("email") )
            <div class="sharebutton">
                &#160;<a href="mailto:?subject=Upstate.edu:%20$systemPageTitleURLd&amp;body=Hi,%20I%20found%20this%20website%20and%20thought%20you%20might%20find%20it%20interesting:%0D%0D$systemPageTitleURLd%0Dhttp://www.upstate.edu/$systemPageSite${systemPagePath}.php%20%0D%0D$systemPageSummaryURLd.."><img alt="Send to a Friend" class="imagerollover" src="site://Upstate-Globals/assets/images/email-rwd.gif" title="Send to a Friend" width="32" height="32"/></a>
            </div>
        #end
        
    ##Share print
        #if( $groupToBeProcessed.getChild("share").value.contains("print") )
            <div class="sharebutton">
            <a href="#" onclick="window.print()"><img alt="Print Page" class="imagerollover" src="site://Upstate-Globals/assets/images/print-rwd.gif" title="Print Page" width="32" height="32" /></a>
            </div>
        #end    
            
    ##Add to Any
        #if( $groupToBeProcessed.getChild("share").value.contains("facebook") || $groupToBeProcessed.getChild("share").value.contains("twitter") || $groupToBeProcessed.getChild("share").value.contains("addtoany") )
            <div class="a2a_kit a2a_kit_size_32 a2a_default_style alignleft hide-link-icon">
                #if( $groupToBeProcessed.getChild("share").value.contains("facebook") )
                    <a title="Share to Facebook" class="a2a_button_facebook"></a>
                #end
                #if( $groupToBeProcessed.getChild("share").value.contains("twitter") )
                <a  title="Share to Twitter" class="a2a_button_twitter"></a>
                #end
                #if( $groupToBeProcessed.getChild("share").value.contains("addtoany") )
                <a  title="Share..." class="a2a_dd" href="https://www.addtoany.com/share"></a>
                #end
            </div>
            <script>var a2a_config = a2a_config || {};a2a_config.onclick = 1;a2a_config.exclude_services = ["email"];a2a_config.prioritize = ["wordpress"];</script>
            <script async="true" src="https://static.addtoany.com/menu/page.js"></script> 
        #end
        </div> ##buttons        
    </div>  
    <div class="clr"></div>
    
    ##Previous and Next
    
    #if( $groupToBeProcessed.getChild("show-options").value.contains("Previous and Next") )
        #set( $articleIndexBlock = $groupToBeProcessed.getChild("article-index-block").getChild("content").getChild("system-index-block") )
        #set( $defaultFile = "images/default.jpg" )
        #set( $articles = $_XPathTool.selectNodes( $articleIndexBlock,
            "system-folder/system-page[name!='index']" ) )
    
        ## get all articles, aka any page on the site that has a start date:
        ##set ( $articles = $_XPathTool.selectNodes( $findIndexBlock, "system-page[name]" ) )
        ##set ( $articles = $_XPathTool.selectNodes( $findIndexBlock, "//system-page[start-date]" ) )
        $_SortTool.addSortCriterion( "start-date", "", "number", "ascending", "upper-first" )
        $_SortTool.sort( $articles )
    
        ## find current article:
        #foreach( $eachArticle in $articles )
            #if( $eachArticle.getAttribute( "current" ) )
                ## #chanwProcessSystemPage( $eachArticle )
                #set( $prevIndex    = $articles.indexOf( $eachArticle ) - 1 )
                #set( $nextIndex    = $articles.indexOf( $eachArticle ) + 1 )
        
                ##get previous and next array listings:
                #set( $prevNextList = [ $prevIndex, $nextIndex ] )
        
                ##create previous and next previews:
                #foreach( $prevNextCount in $prevNextList )
                    #if( $prevNextCount >= 0 && $prevNextCount < $articles.size() )
                        #chanwProcessSystemPage( $articles[ $prevNextCount ] )
                        #set ($previewArticleYear      = $articles[$prevNextCount].getParent().getChild("name").value )
                        #set( $previewPreviousNextText = "Previous" )
                        
                        #if( $foreach.count == 2 )
                            #set( $previewPreviousNextText = "Next" )
                        #end
                        
                        ## Do images exist?
                        #chanwReinitializeListOfVariables ( [ "fileSizeTest", "imageLocation" , "src", "imageDoesNotExist" ] )
                        
                        #set( $regularFile = "images" + $systemPagePath + ".jpg" )
                        #set( $smallerFile = "images" + $systemPagePath + "-400x200.jpg" )
                        #set( $fileList = [ $smallerFile, $regularFile, $defaultFile ] )
                        #thomaspeGetFeedPhoto( $systemPageSite $fileList  )
                        #set( $src   = "site://" + $systemPageSite + "/" + $thomaspeGetFeedPhoto )
                        
                        #set( $imageLocation = 'images' + $systemPagePath + '.jpg' )
                        #set( $fileSizeTest = $_.locateFile($imageLocation , $systemPageSite ) )
                        #if ($_PropertyTool.isNull($fileSizeTest.FileSize))
                            #set( $imageLocation = 'images/default.jpg' )
                            #set( $fileSizeTest = $_.locateFile($imageLocation , $systemPageSite ) )
                            #if ($_PropertyTool.isNull($fileSizeTest.FileSize))
                                #set( $imageDoesNotExist = true)
                            #end
                        #end
                        #if ($systemPageTitle != $systemPageSummary)
                            <div class="col-4xs-6 padleft3 padright3 padbottom3 padtop9">
                                <p class="padleft5"><strong>$previewPreviousNextText Article:</strong></p>
                                <div class="newsfeed-item">
                                    <a href="$systemPageLink">
                                        <div class="pad5">
                                            #if ($thomaspeGetFeedPhoto != "")
                                                <img alt="$systemPageTitle.replaceAll('&amp;amp;','&amp;')" src="$src" class="img-responsive padtop5 padbottom5" />
                                            #end
                                            <h3>$systemPageTitle.replaceAll("&amp;amp;","&amp;")</h3>
                                            <p>$systemPageSummary.replaceAll("&amp;amp;","&amp;")</p>
                                        </div>
                                        <div class="clr"></div>
                                    </a>   
                                </div>
                            </div>
                        #end
                    #end
                #end
                ##</div>
            #end ## if current
        #end ## for each  
    #end ## if prevous next  
    <div class="clr"></div>
#end ## macro
#*
《/macro》
《documentation》
《code》#processBlockGroup( $groupToBeProcessed )《/code》
《p》Processes the block-group to create a bluepage entry. This macro is invoked
by 《code》processPhpStaticInclude《/code》.《/p》
《/documentation》
《macro id=“processBlockGroup”》
*#
#macro( processBlockGroup $groupToBeProcessed )
    #set( $feed_block = $groupToBeProcessed.getChild( "feed-block" ) )
    #set( $code_block = $groupToBeProcessed.getChild( "code-block" ) )
    
    $globalStringBuffer.setLength( 0 )
    #set( $void = $globalStringBuffer.append( "[system-view:internal]" ) )
    #set( $void = $globalStringBuffer.append( $_SerializerTool.serialize( $feed_block.getChild( "content" ), true ) ) )
    #set( $void = $globalStringBuffer.append( "[/system-view:internal][system-view:external]" ) )
    #set( $void = $globalStringBuffer.append( $_SerializerTool.serialize( $code_block.getChild( "content" ), true ) ) )
    #set( $void = $globalStringBuffer.append( "[/system-view:external]" ) )
    $globalJDOMText.normalizeString( $globalStringBuffer.toString() )
#end
#*
《/macro》
《documentation》
《code》#processCategoryGroup( $groupToBeProcessed )《/code》
《p》Processes the category-group.《/p》
《/documentation》
《macro id=“processCategoryGroup”》
*#
#macro( processCategoryGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.getChild("category-yes").value.contains("Yes") )
        $S_PHP_PASSTHROUGH
        require_once( '/webfs/www/bioinbrief/_extra/headlines-${currentPage.name}.htm' );
        $E_PHP_PASSTHROUGH
    #end
#end
#*
《/macro》
《documentation》
《code》#processContactGroup( $groupToBeProcessed )《/code》
《p》Processes the contact-group.《/p》
《/documentation》
《macro id=“processContactGroup”》
*#
#macro( processContactGroup $groupToBeProcessed )
	#if( $groupToBeProcessed.name != 'contact-group' )
		Not a Contact group
		#stop
	#end
	
    $globalStringBuffer.setLength( 0 )
    #set( $void = $globalStringBuffer.append( "<div class='contactbox'>" ) )
    
    #if( $groupToBeProcessed.getChild( 'contact-intro-text' ).value != "" )
    	#set( $void = $globalStringBuffer.append( "<span class='label'>" ) )
    	#set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $groupToBeProcessed.getChild( 'contact-intro-text' ).value ) ) )
    	#set( $void = $globalStringBuffer.append( "</span><br />" ) )
    #end
    
    #if( $groupToBeProcessed.getChild( 'contact-name' ).value != "" )
    	#if( $groupToBeProcessed.getChild( 'contact-keep-contact-label' ).value == 'Yes' )
    		#set( $void = $globalStringBuffer.append( "<span class='label'>Contact:</span> " ) )
        #else
        	#set( $void = $globalStringBuffer.append( "<span class='padleft9'></span>" ) )
    	#end
    	#set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $groupToBeProcessed.getChild( 'contact-name' ).value ) ) )
    	#if( $groupToBeProcessed.getChild( 'contact-title' ).value != "" )
    		#set( $void = $globalStringBuffer.append( ", <em>" ) )
    		#set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $groupToBeProcessed.getChild( 'contact-title' ).value ) ) )
    		#set( $void = $globalStringBuffer.append( "</em><br />" ) )
        #else
            #set( $void = $globalStringBuffer.append( "<br />" ) )
    	#end
    #end
    
    #if( $groupToBeProcessed.getChild( 'contact-location' ).value != "" )
        #set( $void = $globalStringBuffer.append( "<span class='label'>Location:</span> " ) )
    	#set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $groupToBeProcessed.getChild( 'contact-location' ).value ) ) )
    	#set( $void = $globalStringBuffer.append( "<br />" ) )
    #end
    
    #set( $contactGroups = $groupToBeProcessed.getChildren( 'contact-af-group' ) )
    
    #if( $contactGroups.size() > 0 )
        #foreach( $contactGroup in $contactGroups )
        	#if( $contactGroup.getChild( 'contact-af-content' ).value != "" )
    			#if( $contactGroup.getChild( 'contact-af-label' ).value != "" )
        			#set( $void = $globalStringBuffer.append( "<span class='label'>") )
            		#set( $void = $globalStringBuffer.append( $contactGroup.getChild( 'contact-af-label' ).value ) )
            		#set( $void = $globalStringBuffer.append( ":</span> ") )
    				#set( $void = $globalStringBuffer.append( $contactGroup.getChild( 'contact-af-content' ).value ) )
    			#end
                #set( $void = $globalStringBuffer.append( "<br />" ) )
    		#end
    	#end
    #end
    
    #if( $groupToBeProcessed.getChild( 'contact-phone' ).value != "" )
    	#set( $void = $globalStringBuffer.append( "<span class='label'>Phone:</span> " ) )
    	#set( $void = $globalStringBuffer.append( $groupToBeProcessed.getChild( 'contact-phone' ).value ) )
    	#set( $void = $globalStringBuffer.append( "<br />" ) )
    #end
    
    #if( $groupToBeProcessed.getChild( 'contact-fax' ).value != "" )
    	#set( $void = $globalStringBuffer.append( "<span class='label'>Fax:</span> " ) )
    	#set( $void = $globalStringBuffer.append( $groupToBeProcessed.getChild( 'contact-fax' ).value ) )
    	#set( $void = $globalStringBuffer.append( "<br />" ) )
    #end
    
    #if( $groupToBeProcessed.getChild( 'contact-email' ).value != "" )
    	#set( $email = $groupToBeProcessed.getChild( 'contact-email' ).value )
    	#set( $void = $globalStringBuffer.append( "<span class='label'>Email:</span> " ) )
    	#set( $void = $globalStringBuffer.append( "<a href='mailto:$email'>$email</a>" ) )
    #end
    
    #set( $void = $globalStringBuffer.append( "</div>" ) )
    $globalJDOMText.normalizeString( $globalStringBuffer.toString() )
#end
#*
《/macro》
《documentation》
《code》#processGalleryGroup( $groupToBeProcessed )《/code》
《p》Processes the gallery-group.《/p》
《/documentation》
《macro id=“processGalleryGroup”》
*#
#macro( processGalleryGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'gallery-group' )
        Not a Gallery group
        #stop
    #end
    
    <div id="vlightbox1">
        #set( $selectImage              = $_XPathTool.selectNodes($groupToBeProcessed, 'gallery-image-group'))
        
        #foreach ($selectedImage in $selectImage)
            #set( $galleryImage            = $selectedImage.getChild( "gallery-image-chooser" ).getChild( "link" ).value )
            #set( $galleryImagePath        = $selectedImage.getChild( "gallery-image-chooser" ).getChild( "path" ).value )
            #set( $galleryImageSite        = $selectedImage.getChild( "gallery-image-chooser" ).getChild( "site" ).value )
            #set( $galleryCaption          = $selectedImage.getChild( "gallery-image-caption" ).value )
            
            #set($galleryThumb = $galleryImage )
            #if (!$_PropertyTool.isNull($_.locateFile($galleryImagePath.replaceAll(".jpg","-400x200.jpg"), $galleryImageSite ) ))
                #set($galleryThumb = $galleryImage.replaceAll(".jpg","-400x200.jpg") )
            #end
            
            <a class="vlightbox1" href="$galleryImage" title="$galleryCaption">
                <img src="${galleryThumb}" width="150" height="75" alt="$galleryCaption" class="pad5 imagerollover" />
            </a>   
        #end

    </div>
    <script src="/assets/js/vlbdata1.js" type="text/javascript"></script>
    <style type="text/css">.a2a_svg, .a2a_count { border-radius: 0 !important; }</style>
#end
#*
《/macro》
《documentation》
《code》#processHomepageSlideshowGroup( $groupToBeProcessed )《/code》
《p》Processes the homepage-slideshow-group.《/p》
《/documentation》
《macro id=“processHomepageSlideshowGroup”》
*#
#macro( processHomepageSlideshowGroup $groupToBeProcessed )
     #if( $groupToBeProcessed.name != 'homepage-slideshow-group' )
        Not a Slideshow group
        #stop
    #end
    
    $globalStringBuffer.setLength( 0 )
    
    ## the variable $groupRegion is set in blocks/code/global-velocity-code
    #if( !$_PropertyTool.isNull( $groupRegion ) )
        #set( $slideshow_div = "<div id='hide-" + $groupRegion + "'>" )
        #set( $void          = $globalStringBuffer.append( $slideshow_div ) )
    #end

    #set( $void           = $globalStringBuffer.append( '<div class="flexslider"><ul class="slides">' ) )
    #set( $captionClass   = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'caption-class' ).value )
    #set( $largeSuffix    = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'large-suffix' ).value )
    #set( $mediumSuffix   = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'medium-suffix' ).value )
    #set( $smallSuffix    = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'small-suffix' ).value )
    #set( $subheadlineYes = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'subheadlineYes/value' ).value )
    #set( $selectImages   = $_XPathTool.selectNodes( $groupToBeProcessed, 'image' ) )

    #foreach($selectedImage in $selectImages )
        #set( $captionYes               = $selectedImage.getChild( "caption-yes" ).value )
        #set( $altText                  = $selectedImage.getChild( "altText" ).value )
        #set( $captionSub               = $selectedImage.getChild( "subheadline" ).value )
        #set( $imageHPLink              = "" )
        #if ( $selectedImage.getChild("image-link").getAttribute("type").value == "symlink" )
            #set( $imageHPLink          = $selectedImage.getChild("image-link").getChild("content").value )        
        #else
            #set( $imageHPLink          = $_XPathTool.selectSingleNode($selectedImage,'image-link/link').value )
        #end
        #set( $singleImage              = $selectedImage.getChild( "selectimage" ).getChild( "link" ).value )
            #set( $singleImageSite          = $selectedImage.getChild( "selectimage" ).getChild( "site" ).value )
            #set( $singleImagePath          = $selectedImage.getChild( "selectimage" ).getChild( "path" ).value )

            #thomaspeSrcSetValues
            #thomaspeGetSrcSetCode( $singleImagePath $singleImageSite $thomaspeSrcSetValues)
            ## $thomaspeGetSrcSetCode
            
        #set( $void = $globalStringBuffer.append( '<li>' ) )

        #if( $imageHPLink != "" )
            #set( $void = $globalStringBuffer.append( "<a href='$imageHPLink' class='hide-link-icon'>" ) )
        #end

        #set( $void = $globalStringBuffer.append( '<div class="slide">' ) )
        #set( $void = $globalStringBuffer.append( "<img alt='${_EscapeTool.xml($altText)}' src='${singleImage}' $thomaspeGetSrcSetCode />" ) )
        #set( $void = $globalStringBuffer.append( '</div>' ) )

        #if( $captionYes != "" )
            #set( $void = $globalStringBuffer.append( "<div class='${captionClass}'>" ) )

            #if($subheadlineYes != "")
                #set( $void = $globalStringBuffer.append( '<h2>' ) )
                #set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $altText ) ) )
                #set( $void = $globalStringBuffer.append( '</h2>' ) )
                #set( $void = $globalStringBuffer.append( "<p>$captionSub</p>" ) )
            #else
                #set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $altText ) ) )
            #end

            #set( $void = $globalStringBuffer.append( '</div>' ) )
        #end

        #if( $imageHPLink != "")
            #set( $void = $globalStringBuffer.append( '</a>' ) )
        #end

        #set( $void = $globalStringBuffer.append( '</li>' ) )
    #end

    #set( $void = $globalStringBuffer.append( '</ul></div>' ) )
    #set( $script_str = '<script type="text/javascript">' +
        "$(window).load(function(){ $('.flexslider').flexslider({ animation: 'slide', });});" + "</script>" )
    #set( $void = $globalStringBuffer.append( $script_str ) )
    
    
    #if( !$_PropertyTool.isNull( $groupRegion ) )
        #set( $void = $globalStringBuffer.append( "</div>" ) )
    #end
    $globalJDOMText.normalizeString( $globalStringBuffer.toString() ) 
#end
#*
《/macro》
《documentation》
《code》#processInstructionBlockGroup( $groupToBeProcessed )《/code》
《p》Processes the instruction-block-group. Currently only data definition blocks
and index blocks can be attached to the first chooser. For data definition blocks,
the better way is to use macro blocks.《/p》
《/documentation》
《macro id=“processInstructionBlockGroup”》
*#
#macro( processInstructionBlockGroup $groupToBeProcessed )
    #set( $block_to_be_processed = $_XPathTool.selectSingleNode( $groupToBeProcessed, "block/content" ).getChildren().get( 0 ) )
    ## try dd block first; note the setting of the variable $block_system_data_structure,
    ## which should appear in the accompanying script block
    #if( $block_to_be_processed.name == "system-data-structure" )
        #set( $block_system_data_structure = $block_to_be_processed )
    ## note the setting of the variable $block_system_index_block
    #elseif( $block_to_be_processed.name == "system-index-block" )
        #set( $block_system_index_block = $block_to_be_processed )
    ## add code here to process feed blocks and XML blocks
    #end

    #set( $instruction_scripts = $_XPathTool.selectSingleNode( $groupToBeProcessed, "instruction/content/scripts" ) )
    #chanwProcessScript( $instruction_scripts )
#end
#*
《/macro》
《documentation》
《code》#processLocalWysiwygGroup( $groupToBeProcessed )《/code》
《p》Processes the tab-group.《/p》
《/documentation》
《macro id=“processLocalWysiwygGroup”》
*#
#macro( processLocalWysiwygGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'local-wysiwyg-group' )
        Not a WYSIWYG group
		#stop
	#end
    $S_PHP_PASSTHROUGH
    if ($localflag==1){
    $E_PHP_PASSTHROUGH
    <div class="bg5 pad5 marginbottom3 margintop3 solid1 round5">
        <p>(<em>Contents in this box are only visible on campus</em>)</p>
        $_SerializerTool.serialize( $groupToBeProcessed.getChild( 'wysiwyg-content' ), true )
    </div>
    $S_PHP_PASSTHROUGH } $E_PHP_PASSTHROUGH
#end
#*
《/macro》
《documentation》
《code》#processQuickLinksGroup( $groupToBeProcessed )《/code》
《p》Processes the quick-links-group.《/p》
《/documentation》
《macro id=“processQuickLinksGroup”》
*#
#macro( processQuickLinksGroup $groupToBeProcessed )
	#if( $groupToBeProcessed.name != 'quick-links-group' )
		Not a Quick links group
		#stop
	#end
	
	$globalStringBuffer.setLength( 0 )
    #set( $quickLinksClass = $groupToBeProcessed.getChild( 'quick-links-class' ).value )
    #set( $quickLinksTitle = $groupToBeProcessed.getChild( 'quick-links-title' ).value )
    #set( $quickLinksListGroups = $groupToBeProcessed.getChildren( 'quick-links-list-group' ) )
    
    #if( $quickLinksListGroups.size() > 0 )
    	#set( $void = $globalStringBuffer.append( "<div class='${quickLinksClass}'>" ) )
    
        #if( $quickLinksTitle != "" )
        	#set( $void = $globalStringBuffer.append( "<div class='links-header'>$quickLinksTitle</div>" ) )
        #end
        
        #if( $quickLinksClass != 'quick-links-no-bullets' )
        	#set( $startTags = '<div class="links-content"><ul>' )
        	#set( $startTag  = '<li>' )
        	#set( $endTags = '</ul></div>' )
        	#set( $endTag  = '</li>' )
        #else
        	#set( $startTags = '<div class="links-content">' )
        	#set( $startTag  = '<div class="quick-links-item">' )
        	#set( $endTags = '</div>' )
        	#set( $endTag  = '</div>' )
        #end
        
        #set( $void = $globalStringBuffer.append( $startTags ) )
        
		#foreach( $quickLinksListGroup in $quickLinksListGroups )
			#set( $linkIcon = "" )
			
			#if( $quickLinksListGroup.getChild( 'quick-links-icon' ).value != 'None' )
				#set( $linkIcon = $quickLinksListGroup.getChild( 'quick-links-icon' ).value.toLowerCase() )
				#if( $linkIcon == 'intra' )#set( $linkIcon = 'key' )#end
				#set( $iconSrc = "http://www.upstate.edu/assets/images/icons/${linkIcon}-icon.gif" )
				#set( $imgElement = " <img src='$iconSrc' alt='$linkIcon' title='$linkIcon' />" )
			#else
				#set( $iconSrc = "" )
				#set( $imgElement = "" )
			#end
				
			#if( $quickLinksListGroup.getChild( 'quick-links-linkable' ).getAttribute( 'type' ).value == 'page' ||
				$quickLinksListGroup.getChild( 'quick-links-linkable' ).getAttribute( 'type' ).value == 'file'
			)
				#set( $linkHref = $quickLinksListGroup.getChild( 'quick-links-linkable' ).getChild( 'link' ).value )
			#else ## symlink
				#set( $linkHref = $quickLinksListGroup.getChild( 'quick-links-linkable' ).getChild( 'content' ).getChild( 'system-symlink' ).value )
			#end
			
			#set( $void = $globalStringBuffer.append( "$startTag<a href='${linkHref}'>" ) )
			#set( $void = $globalStringBuffer.append( $_EscapeTool.xml( $quickLinksListGroup.getChild( 'quick-links-text' ).value ) ) )
			#set( $void = $globalStringBuffer.append( "$imgElement</a>$endTag" ) )
		#end
        #set( $void = $globalStringBuffer.append( "$endTags</div>" ) )
        $globalJDOMText.normalizeString( $globalStringBuffer.toString() )
    #end
#end
#*
《/macro》
《documentation》
《code》#processRandomImageGroup( $groupToBeProcessed )《/code》
《p》Processes the random-image-group.《/p》
《/documentation》
《macro id=“processRandomImageGroup”》
*#
#macro( processRandomImageGroup $groupToBeProcessed )
    #chanwReinitializeListOfVariables ( [ "captionYes" ] )
    #set( $images           = $groupToBeProcessed.getChildren( "image" ) )
    #set( $captionYes       = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'caption-yes' ).value )  
    #set( $numberOfImages   = $images.size() )
    #set( $randImage        = $_MathTool.random(0,$numberOfImages) )    

    $S_PHP_PASSTHROUGH $imagearray = array(); $E_PHP_PASSTHROUGH
    #foreach( $image in $images )
        #chanwReinitializeListOfVariables ( [ "imageLink" ] )
        #set( $singleImage  = $image.getChild( "selectimage" ).getChild( "link" ).value )
        #set( $altText      = $image.getChild( "altText" ).value )
        #if ( $image.getChild("image-link").getAttribute("type").value == "symlink" )
            #set( $imageLink          = $image.getChild("image-link").getChild("content").value )        
        #else
            #set( $imageLink          = $_XPathTool.selectSingleNode($image,'image-link/link').value )
        #end

        #set( $singleImageSite          = $image.getChild( "selectimage" ).getChild( "site" ).value )
        #set( $singleImagePath          = $image.getChild( "selectimage" ).getChild( "path" ).value )

            #thomaspeSrcSetValues
            #thomaspeGetSrcSetCode( $singleImagePath $singleImageSite $thomaspeSrcSetValues)
            ## $thomaspeGetSrcSetCode

        #if($imageLink != "")    
            #set( $int_img      = "<div class='imageblock padbottom5 padright3'><a href='${imageLink}.php' class='hide-link-icon'><div class='slide'>" )   
        #else
            #set( $int_img      = "<div class='imageblock padbottom5 padright3'><div class='slide'>" )
        #end
        #set( $int_img      = $int_img + "<img src='${singleImage}' alt='${_EscapeTool.xml($altText)}' class='img-responsive' $thomaspeGetSrcSetCode />" )
        #set( $int_img      = $int_img + "</div>" )
        #if ($captionYes != "" && $altText.length() <= 62)
            #set( $int_img      = $int_img + "<div class='flexslider-caption'>${altText} </div>" )
        #end
        #if($imageLink != "")  
            #set( $int_img      = $int_img + "</a>" )
        #end
        
        #if ($captionYes != "" && $altText.length() > 62)
            #set( $int_img      = $int_img + "<div class='caption padtop3'>${_EscapeTool.xml($altText)}</div>" )
        #end
        
        #set( $int_img          = $int_img + "</div>" )
        #set( $ext_img          = $_EscapeTool.Q + $int_img + $_EscapeTool.Q )
        #set( $ext_img          = $ext_img.replaceAll( "site:/", "" ) )
  ##      #set( $ext_img          = $ext_img.replaceAll( "-dev", "" ) )
        #set( $ext_img          = $ext_img.replaceAll( "\[system-asset:local\]", "" ).replaceAll( "\[/system-asset:local\]", "" ) )
        #set( $int_img          = $int_img.replaceAll( ".php", "" ) )
        #if( $foreach.index == $randImage )
            [system-view:internal]${int_img}[/system-view:internal]
        #end
        $S_PHP_PASSTHROUGH array_push( $imagearray, $ext_img ); $E_PHP_PASSTHROUGH
    #end
    $S_PHP_PASSTHROUGH loadRandomImage($imagearray); $E_PHP_PASSTHROUGH
#end
#*
《/macro》
《documentation》
《code》#processRowGroup( $groupToBeProcessed )《/code》
《p》Processes the row-group.《/p》
《/documentation》
《macro id=“processRowGroup”》
*#
#macro( processRowGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'row-group' )
        Not a Row group
        #stop
    #end
    
    #set( $MEDIA_SIZE            = "sm" )
    #set( $OPTION_CENTERD_HEADER = "centered header" )
    #set( $OPTION_FULL_WIDTH     = "full width" )
    #set( $OPTION_EVEN_COLUMN    = "even column" )
    #set( $OPTION_PADDING        = "padding" )
    #set( $OPTION_MARGIN         = "margin" )
    #set( $OPTION_BOTTOM_SPACING = "bottom spacing" )
    #set( $OPTION_BOTTOM_HR      = "bottom hr" )

    #set( $background_classes  = $groupToBeProcessed.getChild( "background-classes" ).Value )
    #set( $row_header = $groupToBeProcessed.getChild( "row-header" ).Value )
    #set( $options_list = [] )
    #set( $options = $groupToBeProcessed.getChild( "options" ) )
    #set( $options_values = $options.getChildren( "value" ) )
    
    #if( $options_values )
        #foreach( $value in $options_values )
            #set( $dummy = $options_list.add( $value.Value ) )
        #end
    #end
    
    #if( $row_header && $row_header.trim() != "" )
        #if( $options_list.contains( $OPTION_CENTERD_HEADER ) )
            #chanwReviveGlobalVariable( "RowCenterHeaderClasses" $design_namespace )
        #else
            #chanwReviveGlobalVariable( "RowDefaultHeaderClasses" $design_namespace )
        #end

        #set( $header_str = "<div class='${chanwReviveGlobalVariable}'><div class='col-${MEDIA_SIZE}-12 nopadding'><h2>$row_header</h2></div></div>" )
    #else
        #set( $header_str = '' )
    #end

    #set( $block_choosers = $_XPathTool.selectNodes( $groupToBeProcessed, "row-block-chooser/content" ) )
    
    #if( $block_choosers.size() > 0 )
        #if( $options_list.contains( $OPTION_MARGIN ) )
            #set( $margin_style = " style='padding-bottom:30px'" )
        #else
            #set( $margin_style = "" )
        #end
        <div class="${background_classes}"${margin_style}>

        #if( !$options_list.contains( $OPTION_FULL_WIDTH ) )<div class="container nopadding">
        #else<div class="container-fluid nopadding">#end
$header_str

<div class="row nopadding">## 2
        #if( $options_list.contains( $OPTION_EVEN_COLUMN ) )
            #if( $block_choosers.size() > 0 && $block_choosers.size() < 7 && $block_choosers.size() != 5 )
                #set( $col_width = 12 / $block_choosers.size() )
                
                #if( $options_list.contains( $OPTION_PADDING ) )
                    #set( $div_class = "col-${MEDIA_SIZE}-${col_width}" )
                #else
                    #set( $div_class = "col-${MEDIA_SIZE}-${col_width} nopadding" )
                #end
            #else
                #set( $div_class = "" )
            #end
        #else
            #set( $div_class = "" )
        #end

        #foreach( $block_chooser in $block_choosers )
            #if( $options_list.contains( $OPTION_EVEN_COLUMN ) )
                #if( $div_class == "" )
                    #chanwProcessBlockChooser( $block_chooser )
                #else
<div class="${div_class}">#chanwProcessBlockChooser( $block_chooser )</div>
                #end
            #else
                #chanwProcessBlockChooser( $block_chooser )
            #end
        #end
</div>##2
</div>##3
</div>
    #end
    #if( $options_list.contains( $OPTION_BOTTOM_SPACING ) )
<div class="pad9"></div>
    #end
    
    #if( $options_list.contains( $OPTION_BOTTOM_HR ) )
<hr />
<div class="pad9"></div>
    #end
#end
#*
《/macro》
《documentation》
《code》#processScriptsGroup( $groupToBeProcessed )《/code》
《p》Processes the scripts-group.《/p》
《/documentation》
《macro id=“processScriptsGroup”》
*#
#macro( processScriptsGroup $groupToBeProcessed )
    #set( $scripts = $groupToBeProcessed.children )
    
    #foreach( $script in $scripts )
        #set( $scriptPath = $script.getChild( "path" ).value )
        #set( $chanwStatement = "#" + "import('$scriptPath')" )
        #evaluate( $chanwStatement )
        
        #set( $macros = $script.getChildren( "macro-group" ) )
        #set( $chanwStatement = "" )
        
        #foreach( $macro in $macros )
            #set( $macroName = $macro.getChild( "name" ).value )
            #set( $chanwStatement = "#" + $macroName + "(" )
            
            #set( $paramGroups = $macro.getChildren( "params-group" ) )
            
            #foreach( $paramGroup in $paramGroups )
                #set( $variables = $paramGroup.getChildren( "variable" ) )
                #set( $params = $paramGroup.getChildren( "param" ) )
                
                #foreach( $variable in $variables )
                    #if( $variable.value.trim() != "" )
                        
                        #set( $chanwStatement = $chanwStatement + "$" + $variable.value + " " )
                    #end
                #end
                #foreach( $param in $params )
                    #if( $param.value.trim() != "" )
                        #set( $chanwStatement = $chanwStatement + "$" + $param.value + " " )
                    #end
                #end
            #end
            
            #set( $chanwStatement = $chanwStatement + ")" )
        #end
        
        #evaluate( $chanwStatement )
    #end
#end
#*
《/macro》
《documentation》
《code》#processSimpleTableGroup( $groupToBeProcessed )《/code》
《p》Processes the simple-table-group.《/p》
《/documentation》
《macro id=“processSimpleTableGroup”》
*#
#macro( processSimpleTableGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'simple-table-group' )
        Not a Simple Table
    	#stop
	#end
    #set( $tablesummary  = $_XPathTool.selectSingleNode( $groupToBeProcessed, 'table-summary' ).value )
    <table class="table-upstate" summary="$tablesummary">
      <tbody>
        #set( $columnnumbers  = [1..$_MathTool.toInteger($_XPathTool.selectSingleNode( $groupToBeProcessed, 'column-number' ).value)])
        <tr>
        #foreach($column in $columnnumbers)
                #set ($headername = "heading" + $foreach.count)
                #set ($headertext =  $_EscapeTool.xml($_XPathTool.selectSingleNode( $groupToBeProcessed, $headername ).value))               
                <th class="table-header">$headertext</th>
        #end
        </tr>     
        #set($rows = $groupToBeProcessed.getChildren('rows'))        
        #foreach($row in $rows)
            #if($foreach.count % 2 == 1)
                #set($trclass=" class='tablerow1'")
            #else
                #set($trclass="")
            #end
            <tr${trclass}>
            #foreach($column in $columnnumbers)
                    #set ($columnvalue = "")    
                    #set ($columntypetest = "column" + $foreach.count + "-type")
                    #set ($columntype = $_XPathTool.selectSingleNode( $groupToBeProcessed, $columntypetest ).value) 
                    #if( $columntype == "text box")
                        #set ($columnLocation = "column-" + $foreach.count + "-textbox")
                        #set ($columnvalue =  $_EscapeTool.xml($row.getChild($columnLocation).value))
                    #else
                        #set ($columnLocation = "column-" + $foreach.count + "-wysiwyg")
                        #set ($columnvalue = $_SerializerTool.serialize( $row.getChild($columnLocation), false ) )
                    #end
                    <td>$columnvalue</td>
            #end
            </tr>
        #end
      </tbody>
     </table>
#end
#*
《/macro》
《documentation》
《code》#processSingleimageGroup( $groupToBeProcessed )《/code》
《p》Processes the singleimage-group.《/p》
《/documentation》
《macro id=“processSingleimageGroup”》
*#
#macro( processSingleimageGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'singleimage-group' )
        Not a Single Image group
        #stop
	#end

    #chanwReinitializeListOfVariables ( [ "imageRollover", "imageSingleLink", "captionYes" ] )
    
    #set( $singleImage              = $groupToBeProcessed.getChild( "selectimage" ).getChild( "link" ).value )
    #set( $altText                  = $groupToBeProcessed.getChild( "altText" ).value )
    #set( $captionYes               = $groupToBeProcessed.getChild( "caption-yes" ).value )
    
    #if ( $groupToBeProcessed.getChild( "image-link" ).getAttribute( "type" ).value == "symlink" )
        #set( $imageSingleLink = $groupToBeProcessed.getChild(
            "image-link" ).getChild( "content" ).getChild( "system-symlink" ).value )
    #else
        #set( $imageSingleLink = $_XPathTool.selectSingleNode($groupToBeProcessed,'image-link/link').value )
    #end

    #set( $singleImageSite          = $groupToBeProcessed.getChild( "selectimage" ).getChild( "site" ).value )
    #set( $singleImagePath          = $groupToBeProcessed.getChild( "selectimage" ).getChild( "path" ).value )
    
    #thomaspeSrcSetValues
    #thomaspeGetSrcSetCode( $singleImagePath $singleImageSite $thomaspeSrcSetValues)
    ## $thomaspeGetSrcSetCode
    
    <div class="imageblock padbottom5 padright3">
    #if( $imageSingleLink != "" )
        <a href="${imageSingleLink}" class="flexslider-link hide-link-icon">
        #set( $imageRollover            = "imagerollover")
    #else
        #set( $imageRollover            = "" )
    #end
    
    #set( $altText = $_EscapeTool.xml( $altText ) )
            <div class="slide">
                <img alt="${altText}" class="img-responsive block center ${imageRollover}" src="${singleImage}" $thomaspeGetSrcSetCode />
            </div>

    #if ($captionYes != "" && $altText.length() <= 62)
        <div class="flexslider-caption">${_EscapeTool.xml($altText)}</div>
    #end
    
    #if( $imageSingleLink != "" )
        </a>
    #end
    
    #if ($captionYes != "" && $altText.length() > 62)
        <div class="caption padtop3">${_EscapeTool.xml($altText)}</div>
    #end
    </div>
#end
#*
《/macro》
《documentation》
《code》#processSlideShowGroup( $groupToBeProcessed )《/code》
《p》Processes the slide-show-group.《/p》
《/documentation》
《macro id=“processSlideShowGroup”》
*#
#macro( processSlideShowGroup $groupToBeProcessed $blockRegion )
    #if( $groupToBeProcessed.name != 'slide-show-group' )
        Not a Slide Show group
        #stop
    #end
    
    #if( !$_PropertyTool.isNull( $blockRegion ) && $blockRegion.trim() != "" )
        #set( $region_div = "<div id='hide-" + $blockRegion + "'>" )
        $region_div
    #end
    <div class="imageblock padbottom5 padright3"><div class="flexslider">
        <ul class="slides">
        #chanwReinitializeListOfVariables ( [  "imageSlideLink", "captionYes", "autoplayOff" ] )
        #set( $selectImage              = $_XPathTool.selectNodes($groupToBeProcessed, 'image'))
        #set( $captionYes               = $groupToBeProcessed.getChild( "caption-yes" ).value )
        #foreach ($selectedImage in $selectImage)
  
            #chanwReinitializeListOfVariables ( [ "imageSlideLink", "singleImageSite" , "singleImagePath"] ) 
            #set( $altText                  = $selectedImage.getChild( "altText" ).value )
            #if ( $selectedImage.getChild("image-link").getAttribute("type").value == "symlink" )
                #set( $imageSlideLink          = $selectedImage.getChild("image-link").getChild("content").value )        
            #else
                #set( $imageSlideLink          = $_XPathTool.selectSingleNode($selectedImage,'image-link/link').value )
            #end

            #set( $singleImage              = $selectedImage.getChild( "selectimage" ).getChild( "link" ).value )
            #set( $singleImageSite          = $selectedImage.getChild( "selectimage" ).getChild( "site" ).value )
            #set( $singleImagePath          = $selectedImage.getChild( "selectimage" ).getChild( "path" ).value )

            #thomaspeSrcSetValues
            #thomaspeGetSrcSetCode( $singleImagePath $singleImageSite $thomaspeSrcSetValues)
            ## $thomaspeGetSrcSetCode
    
            <li>
            #if($imageSlideLink != "")
                <a href="$imageSlideLink" class="flexslider-link hide-link-icon">
            #end
                    <div class="slide">
                        <img alt="${_EscapeTool.xml($altText)}" src="$singleImage" $thomaspeGetSrcSetCode />
                    </div>
                #if ($captionYes != ""  && $altText.length() <= 62 )
                    <div class="flexslider-caption">
                        ${_EscapeTool.xml($altText)}
                    </div>
                #end
            #if($imageSlideLink != "")
                </a>
            #end
            #if ($captionYes != "" && $altText.length() > 62 )
                #set( $autoplayOff  =   "slideshow: false" )
                <div class='caption padtop3'>
                    ${_DisplayTool.truncate($_EscapeTool.xml($altText),600,"…",true)}
                    #if($imageSlideLink != "")
                        (<a href='$imageSlideLink'>more</a>)
                    #end                 
                </div>
            #end
            </li>
        #end
        </ul>
    </div></div>
    
    #set( $script_str = '<script type="text/javascript">' + 
        "$(window).load(function(){ $('.flexslider').flexslider({ animation: 'slide', $autoplayOff });});" + "</script>" )
    $script_str
    
    #if( !$_PropertyTool.isNull( $blockRegion ) && $blockRegion.trim() != "" )
        </div>
    #end
#end
#*
《/macro》
《documentation》
《code》#processTabGroup( $groupToBeProcessed )《/code》
《p》Processes the tab-group.《/p》
《/documentation》
《macro id=“processTabGroup”》
*#
#macro( processTabGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'tab-group' )
        Not a Tab group
        #stop
    #end
    #set( $tabGroups = $groupToBeProcessed.getChildren( 'tab-panel-group' )  )
    #if( $tabGroups.size() > 0 )
        <div id='nav-tabs'>
            <ul class='nav nav-tabs'>
            #foreach( $tabGroup in $tabGroups )
                #set ($activeClass = "" )
                #if($foreach.count == 1)
                    #set($activeClass = " class='active'" )
                #end
                <li${activeClass}><a data-toggle="tab" href="#tab${foreach.count}">
            	    ${_EscapeTool.xml( $tabGroup.getChild( 'tab-label' ).value )}
                </a></li>
		    #end
		    </ul>
        </div>
        <div class='tab-content' id="tab-content">
        #foreach( $tabGroup in $tabGroups )
            #set ($activeClass = "" )
            #if($foreach.count == 1)
                #set($activeClass = " in active" )
            #end
            <div id="tab${foreach.count}" class="tab-pane fade${activeClass}">
                ${_SerializerTool.serialize( $tabGroup.getChild( 'tab-content' ), false )}
            </div>
        #end
        </div>
    #end
    
#end
#*
《/macro》
《documentation》
《code》#processWysiwygGroup( $groupToBeProcessed )《/code》
《p》Processes the wysiwyg-group.《/p》
《/documentation》
《macro id=“processWysiwygGroup”》
*#
#macro( processWysiwygGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'wysiwyg-group' )
        Not a WYSIWYG group
        #stop
    #end
    
    #chanwReviveGlobalVariable( "RenderWysiwygBlock" $design_namespace )
    
    #if( $chanwReviveGlobalVariable )
        $_SerializerTool.serialize( $groupToBeProcessed.getChild( 'wysiwyg-content' ), true )
    #end
#end
#*
《/macro》
《documentation》
《code》#processYoutubeVideoGroup( $groupToBeProcessed )《/code》
《p》Processes the youtube-video-group.《/p》
《/documentation》
《macro id=“processYoutubeVideoGroup”》
*#
#macro( processYoutubeVideoGroup $groupToBeProcessed )
    #if( $groupToBeProcessed.name != 'youtube-video-group' )
        Not a Youtube Video group
        #stop
    #end
    
    #chanwReinitializeListOfVariables ( [ "youtubeVideoCaption", "youtubeVideoWidth", "youtubeVideoHeight" ] )
    #set( $youtubeVideoID           = $groupToBeProcessed.getChild( "video-id" ).value )
    #set( $youtubeVideoCaption      = $groupToBeProcessed.getChild( "video-caption" ).value )
    #set( $youtubeVideoWidth        = $groupToBeProcessed.getChild( "video-width" ).value )
    #set( $youtubeVideoHeight       = $groupToBeProcessed.getChild( "video-height" ).value )

<script src="/render/file.act?path=site://Upstate-Globals/assets/js/jquery.fitvids.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
        $("#video-div").fitVids();
});
</script>
<div class="padbottom5 padright3"><div id="video-div"><iframe title="${youtubeVideoCaption}" width="${youtubeVideoWidth}" height="${youtubeVideoHeight}" allowfullscreen="true" frameborder="0" 
src="http://www.youtube.com/embed/${youtubeVideoID}?rel=0&amp;wmode=transparent"></iframe><div class="caption">$youtubeVideoCaption</div></div>
<div class="pad10"></div></div>
#end
#*
《/macro》
《documentation》
《code》#processPhpStaticInclude( $systemDataStructure )《/code》
《p》Processes a block of bluepage entry. It invokes
《code》processBlockGroup《/code》.《/p》
《/documentation》
《macro id=“processPhpStaticInclude”》
*#
#macro( processPhpStaticInclude $systemDataStructure )
    #set( $groupToBeProcessed = $systemDataStructure.getChild( "block-group" ) )
    #chanwConvertToPascalCase( "block-group" "-" )
    #set( $macroName = $MACRO_PREFIX + $chanwConvertToPascalCase )
    #chanwInvokeMacro( $macroName [ "groupToBeProcessed" ] )
#end
#*
《/macro》
《documentation》
《code》#processNewsArticlePreviousNext( $systemDataStructure )《/code》
《p》Processes a block to produce the previous/next buttons.《/p》
《/documentation》
《macro id=“processNewsArticlePreviousNext”》
*#
#macro( processNewsArticlePreviousNext $systemDataStructure )
    #set( $articleIndexBlock = $systemDataStructure.getChild("article-index-block").getChild("content").getChild("system-index-block") )

    #set( $articles = $_XPathTool.selectNodes( $articleIndexBlock,
        "system-folder/system-page[name!='index']" ) )
   
    ## get all articles, aka any page on the site that has a start date:
    ##set ( $articles = $_XPathTool.selectNodes( $findIndexBlock, "system-page[name]" ) )
    ##set ( $articles = $_XPathTool.selectNodes( $findIndexBlock, "//system-page[start-date]" ) )
    $_SortTool.addSortCriterion( "start-date", "", "number", "ascending", "upper-first" )
    $_SortTool.sort( $articles )

    ## find current article:
    #foreach( $eachArticle in $articles )
        #if( $eachArticle.getAttribute( "current" ) )
            #chanwProcessSystemPage( $eachArticle )
            #set( $prevIndex    = $articles.indexOf( $eachArticle ) - 1 )
            #set( $nextIndex    = $articles.indexOf( $eachArticle ) + 1 )
            #set( $systemPageSite           = $systemPageSite.replaceAll("-dev","") )
            #set( $systemPageTitleURLd      = $systemPageTitle.replaceAll('&amp;amp;','&amp;').replaceAll(' ','%20') )
            #set( $systemPageSummaryURLd    = $systemPageSummary.replaceAll("&amp;amp;","&amp;").replaceAll(' ','%20') )
              
              
            ##get current artcle date and email link:
            ##<div id="hide-whatever">
                <div>
                Published on: $_DateTool.format( 'EEEEE, MMMM d, yyyy', $_DateTool.getDate( $systemPageStartDate ) ) &#160;
                <a href="mailto:?subject=Upstate.edu:%20$systemPageTitleURLd&amp;body=Hi,%20I%20found%20this%20website%20and%20thought%20you%20might%20find%20it%20interesting:%0D%0D$systemPageTitleURLd%0Dhttp://www.upstate.edu/$systemPageSite${systemPagePath}.php%20%0D%0D$systemPageSummaryURLd.."><img alt="Send to a Friend" class="imagerollover" src="site://Upstate-Globals/assets/images/email-rwd.gif" title="Send to a Friend" width="30" height="30"/></a>
                <a href="#" onclick="window.print()"><img alt="Print Page" class="imagerollover" src="site://Upstate-Globals/assets/images/print-rwd.gif" title="Print Page" width="30" height="30" /></a>
                </div>
    
            ##get previous and next array listings:
            #set( $prevNextList = [ $prevIndex, $nextIndex ] )
    
            ##create previous and next previews:
            #foreach( $prevNextCount in $prevNextList )
                #if( $prevNextCount >= 0 && $prevNextCount < $articles.size() )
                    #chanwProcessSystemPage( $articles[ $prevNextCount ] )
                    #set ($previewArticleYear      = $articles[$prevNextCount].getParent().getChild("name").value )
                    #set( $previewPreviousNextText = "Previous" )
                    
                    #if( $foreach.count == 2 )
                        #set( $previewPreviousNextText = "Next" )
                    #end
        
                    <div class="col-4xs-6 padleft3 padright3 padbottom3 padtop9">
                        <p class="padleft5"><strong>$previewPreviousNextText Article:</strong></p>
                        <div class="newsfeed-item">
                            <a href="$systemPageLink">
                                <div class="pad5">
                                    <img alt="$systemPageTitle.replaceAll('&amp;amp;','&amp;')" src="images/$previewArticleYear/${systemPageName}.jpg" class="img-responsive padtop5 padbottom5" />
                                    <h3>$systemPageTitle.replaceAll("&amp;amp;","&amp;")</h3>
                                    <p>$systemPageSummary.replaceAll("&amp;amp;","&amp;")</p>
                                </div>
                                <div class="clr"></div>
                            </a>   
                        </div>
                    </div>
                #end
            #end
            ##</div>
        #end
    #end    
#end
#*
《/macro》
《documentation》
《code》#thomaspeSrcSetValues《/code》
《p》Stores source set information in 《code》$thomaspeSrcSetValues《/code》.《/p》
《/documentation》
《macro id=“thomaspeSrcSetValues”》
*#
#macro( thomaspeSrcSetValues )
    #set( $thomaspeSrcSetValues = {} )
    #set( $void =  $thomaspeSrcSetValues.put( "1000w", [".jpg"] ) )
    #set( $void =  $thomaspeSrcSetValues.put( "750w", ["-700x350.jpg","-700x233.jpg"] ) )
    #set( $void =  $thomaspeSrcSetValues.put( "460w", ["-400x200.jpg","-400x133.jpg"] ) )
#end
#*
《/macro》
《documentation id=“bottom”》
《/documentation》
《/code》
*#